{% extends "base.html" %}

{% block title %}Fluxos de Trabalho · Orquestrador WhatsApp{% endblock %}

{% block content %}
<div class="card">
    <div class="inline-actions" style="justify-content: space-between;">
        <div>
            <h2 style="margin: 0;">Fluxos de trabalho</h2>
            <p style="margin-top: 0.25rem; color: #64748b;">
                Gerencie os fluxos conversacionais disponíveis para integrações com o WhatsApp.
            </p>
        </div>
        <a class="button" href="{{ request.url_for('new_flow_form') }}">Novo fluxo</a>
    </div>

    {% if flows %}
    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Status</th>
                <th>Entrada</th>
                <th>Última atualização</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for flow in flows %}
            <tr>
                <td>
                    <strong>{{ flow.name }}</strong><br />
                    <small>{{ flow.description or '—' }}</small>
                </td>
                <td>{{ flow.status.value }}</td>
                <td>
                    {% if flow.entry_node_id %}
                        Nó #{{ flow.entry_node_id }}
                    {% else %}
                        —
                    {% endif %}
                </td>
                <td>{{ flow.updated_at.strftime('%d/%m/%Y %H:%M') if flow.updated_at else '—' }}</td>
                <td>
                    <a class="btn" href="{{ request.url_for('view_flow', flow_id=flow.id) }}">Abrir</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="margin-top: 1.5rem;">Nenhum fluxo cadastrado até o momento. Clique em <strong>Novo fluxo</strong> para começar.</p>
    {% endif %}
</div>
{% endblock %}